<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0075)https://cw.felk.cvut.cz/courses/a4b33flp/task.php?task=population_evaluator -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="cache-control" content="no-cache">
  <link rel="stylesheet" type="text/css" href="./hw02_assignment_files/default.css">
  <title>Zad�n� �lohy z A4B33FLP</title>
</head>
<div><template shadowrootmode="open"><style>.skip-silence-bar{all:initial;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:#fff;max-height:25px;background:#293033;border-radius:25px;align-items:center;padding:8px 8px 8px 20px;font-family:Poppins,sans-serif;animation:animate-in-command-bar .5s;display:flex;position:fixed;bottom:1rem;right:1rem}.skip-silence-bar .bar-text{align-items:center;display:flex}.skip-silence-bar .info{text-decoration:underline;color:#565656!important}.skip-silence-bar .speed-setting{display:flex}.skip-silence-bar .speed-setting label{white-space:nowrap;align-items:center;margin-right:5px;display:flex}.skip-silence-bar .slider-setting .setting-info{align-items:center;margin-top:0;display:flex}.skip-silence-bar .slider-setting input{display:none}@keyframes animate-in-command-bar{0%{opacity:0}}.skip-silence-bar-collapsed{color:#fff;width:40px;height:40px;cursor:pointer;background:#293033;border-radius:50%;justify-content:center;align-items:center;animation:animate-in-command-collapsed .5s;display:flex;position:fixed;bottom:1rem;right:1rem}@keyframes animate-in-command-collapsed{0%{opacity:0}}.skip-silence-bar,.skip-silence-bar-collapsed{z-index:100000}@font-face{font-family:Poppins;font-style:normal;font-display:swap;font-weight:400;src:url(poppins-devanagari-400-normal.20fc2635.woff2)format("woff2"),url(poppins-all-400-normal.0298587e.woff)format("woff");unicode-range:U+900-97F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:Poppins;font-style:normal;font-display:swap;font-weight:400;src:url(poppins-latin-ext-400-normal.9f87e1a8.woff2)format("woff2"),url(poppins-all-400-normal.0298587e.woff)format("woff");unicode-range:U+100-24F,U+259,U+1E??,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-display:swap;font-weight:400;src:url(poppins-latin-400-normal.53f07e8c.woff2)format("woff2"),url(poppins-all-400-normal.0298587e.woff)format("woff");unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Poppins;font-style:normal;font-display:swap;font-weight:600;src:url(poppins-devanagari-600-normal.5b72b0b7.woff2)format("woff2"),url(poppins-all-600-normal.29420735.woff)format("woff");unicode-range:U+900-97F,U+1CD0-1CF6,U+1CF8-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FB}@font-face{font-family:Poppins;font-style:normal;font-display:swap;font-weight:600;src:url(poppins-latin-ext-600-normal.472ef062.woff2)format("woff2"),url(poppins-all-600-normal.29420735.woff)format("woff");unicode-range:U+100-24F,U+259,U+1E??,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Poppins;font-style:normal;font-display:swap;font-weight:600;src:url(poppins-latin-600-normal.15391d77.woff2)format("woff2"),url(poppins-all-600-normal.29420735.woff)format("woff");unicode-range:U+??,U+131,U+152-153,U+2BB-2BC,U+2C6,U+2DA,U+2DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.skip-silence-bar .header{justify-content:center;align-items:center;margin-left:15px;display:flex}.skip-silence-bar{all:initial;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:#fff;max-height:25px;background:#293033;border-radius:25px;align-items:center;padding:8px 8px 8px 20px;font-family:Poppins,sans-serif;animation:animate-in-command-bar .5s;display:flex;position:fixed;bottom:1rem;right:1rem}.skip-silence-bar .bar-text{align-items:center;display:flex}.skip-silence-bar .info{text-decoration:underline;color:#565656!important}.skip-silence-bar .speed-setting{display:flex}.skip-silence-bar .speed-setting label{white-space:nowrap;align-items:center;margin-right:5px;display:flex}.skip-silence-bar .slider-setting .setting-info{align-items:center;margin-top:0;display:flex}.skip-silence-bar .slider-setting input{display:none}.skip-silence-bar-collapsed{color:#fff;width:40px;height:40px;cursor:pointer;background:#293033;border-radius:50%;justify-content:center;align-items:center;animation:animate-in-command-collapsed .5s;display:flex;position:fixed;bottom:1rem;right:1rem}.skip-silence-bar,.skip-silence-bar-collapsed{z-index:100000}</style><div id="plasmo-shadow-container" style="z-index: 1; position: absolute;"><div id="plasmo-mount-container" style="display: flex; position: relative; top: 0px; left: 0px;"></div></div></template></div><body>


<div class="main">
<h2>Population Evaluator</h2>
<p>
This task is a second step on the path to making a system, which automatically creates programs for a robot in a maze via genetic programming. At the end, the programs will be created from example pairs of the state of the maze before and after the execution of the program. The best program is the shortest and quickest program that can transform any input maze to the desired output maze.
</p>
<p>
The basic law driving the evolution is the higher chance of survival of the best individuals. The individuals in our case are the programs for the robot simulator.  Your second assignment is to implement a function, which will choose the best programs from a given population and sort them according to their quality.
</p>

<h3>Input</h3>
<p><tt>
(evaluate &lt;prgs&gt; &lt;pairs&gt; &lt;threshold&gt; &lt;stack_size&gt;)  
</tt> where</p>
<dl>
<dt><tt>&lt;prgs&gt;</tt></dt><dd>is a list of programs for the robot (as in Task 1). Each program includes a procedure named "start", which is the initial expression for the simulation;</dd>
<dt><tt>&lt;pairs&gt;</tt></dt><dd>is a list of pairs of states, including the position and the orientation of the robot;</dd>
<dt><tt>&lt;threshold&gt;</tt></dt><dd>is lower bounds on the quality of the program in order to appear in the output;</dd>
<dt><tt>&lt;stack_size&gt;</tt></dt><dd>is the limit on the robot simulator stack size (see Task 1).</dd>
</dl>

<h3>Output</h3>
<p>
A sorted list of pairs <tt>((&lt;value&gt; &lt;program&gt;) ... (&lt;value&gt; &lt;program&gt;))</tt> including only the programs, which made it under the threshold.
</p>
<p>
The value of a program has four components that are used in lexicographical order for the final ordering. The components in the decreasing order of importance are the following:
</p>
<ul>
<li>
<b>Manhattan distance</b> between the marks in the state produced by the program and the marks in the desired state of the maze. I.e. the sum of the absolute values of the differences between number of marks present in the output maze and the number of marks present at the same position in the desired maze. The distance between the marks on the following two mazes is 4.
<pre>((w w w w w)   ((w w w w w)
 (w 1 w 1 w)    (w 0 w 1 w)
 (w 3 0 0 w)    (w 1 0 1 w)
 (w w w w w))   (w w w w w))
</pre>
</li>
<li>
<b>Robot configuration distance</b> is the Manhattan distance between the robot final position and the desired final position, plus one, if the robot has wrong orientation.
<p>The distance of <tt>(&lt;maze&gt; (3 2) north) and (&lt;maze&gt; (1 1) north)</tt>  is 3.</p>
<p>The distance of <tt>(&lt;maze&gt; (3 1) north) and (&lt;maze&gt; (1 3) south)</tt>  is 5.</p>
</li>
<li>
<b>The length of the program</b> is the number of commands, tests, procedure calls and procedure declarations in the whole program. We do not count the keywords "procedure" and "if" nor empty sequences. The length of the example "right-hand-rule-prg" from Task 1 is 17. It has 3 tests, 10 commands, 2 procedure calls and 2 procedure declarations.
</li>
<li>
<b>Number of steps</b> (commands) needed by the program to produce the final configuration. It is the number of commands in the output of the simulation for the program. It is 12 in the example from Task 1.
</li>
</ul>
<p>
The final value of a program is a list of four numbers, each representing the sum of the corresponding component above (the length of the program is of course computed only once) over all the input pairs of states.
</p>
<p>
The role of the threshold is to remove obviously wrong programs and to make the evaluation more efficient. As soon as it is clear that an individual will not make it to the output set, the evaluator should stop evaluating (e.g. simulating) the individual in order not to waste computational resources. The threshold for each of the fitness function components is applied separately.  It means that a program which has any of the components of the fitness function higher than the threshold will not appear in the output. Note that the threshold is applied to the sum of the evaluations for all pair not to each evaluation separately. 
</p>

<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample01.ss"><h3>Example:</h3></a>
Consider the following part of Scheme program:
<pre>(define prgs
'(
   ( 
      (procedure start
         (turn-right (if wall? (turn-left 
             (if wall? (turn-left (if wall? turn-left step)) step)) step)
                 put-mark start )
      )   
      (procedure turn-right (turn-left turn-left turn-left))
  )
  (
      (procedure start  (put-mark (if wall? turn-left step) start))
  )
  (
      (procedure start (step step step put-mark))
  )
)
)

(define pairs
'(
  (
   (((w w w w w w) 
     (w 0 w 0 w w) 
     (w 1 w 0 0 w) 
     (w 1 0 0 w w) 
     (w w w w w w)) 
     (1 3) south)

   (((w w w w w w) 
     (w 0 w 0 w w) 
     (w 0 w 0 0 w) 
     (w 0 0 0 w w) 
     (w w w w w w)) 
     (1 1) north)
   )
   (
   (((w w w w w w) 
     (w 0 w 0 w w) 
     (w 0 w 2 0 w) 
     (w 1 3 0 w w) 
     (w w w w w w)) 
     (3 3) north)

   (((w w w w w w) 
     (w 0 w 0 w w) 
     (w 0 w 0 0 w) 
     (w 0 0 0 w w) 
     (w w w w w w)) 
     (1 1) north)
  ))
 )

</pre>
Now we call:
<pre>&gt;  (evaluate prgs pairs '(20 20 20 20) 5)
</pre>
And we obtain (according to the task specification):
<pre>(
((8 5 5 2) ((procedure start (step step step put-mark))))
((18 7 6 20) ((procedure start (put-mark (if wall? turn-left step) start))))
)
</pre>
<h3>
Example 2 (<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample02.in">input</a>,<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample02.out">output</a>),
Example 3 (<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample03.in">input</a>,<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample03.out">output</a>),
Example 4 (<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample04.in">input</a>,<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample04.out">output</a>),
Example 5 (<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample05.in">input</a>,<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample05.out">output</a>),
Example 6 (<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample06.in">input</a>,<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample06.out">output</a>),
Example 7 (<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample07.in">input</a>,<a href="https://cw.felk.cvut.cz/courses/a4b33flp/getdata.php?task=population_evaluator&amp;item=sample07.out">output</a>),
</h3>



</div></body></html>